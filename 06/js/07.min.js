/*! 07 2015-05-07 */
function addTodo(a){a.preventDefault();var b=todoStringField.val();if(todoStringField.val(""),""!=b&&null!=b){var c=$.extend({},Todo.model,{title:b});TodoCollection.add(c)}}function remove(a){if(confirm("정말삭제하시겠습니까?")){var b=$(a.target.parentElement).data("id");TodoCollection.remove(b)}}function onTodoChanged(){var a=TodoCollection.getList();todoView.render(a),Storage.saveData(a)}var Storage={loadData:function(){console.log("loadData()"),TodoCollection.setList(JSON.parse(localStorage.getItem("todo")||"[]"))},saveData:function(a){console.log("saveData()"),localStorage.setItem("todo",JSON.stringify(a))}};!function(){var a={};this.tmpl=function b(c,d){var e=/\W/.test(c)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+c.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):a[c]=a[c]||b(document.getElementById(c).innerHTML);return d?e(d):e}}();var TodoCollection={todoList:[],add:function(a){(null==a.id||""==a.id)&&(a.id=(new Date).getTime().toString()),this.todoList.push(a),$(document.body).trigger("onCollectionChange")},remove:function(a){for(var b in this.todoList)if(this.todoList[b].id==a){this.todoList.splice(b,1),$(document.body).trigger("onCollectionChange");break}},setList:function(a){this.todoList=a,$(document.body).trigger("onCollectionChange")},getList:function(){return this.todoList}},Todo={model:{id:"",title:""}},todoView={todoViewTemplate:"",todoContainer:null,deleteButtonListener:null,init:function(){this.todoViewTemplate=$("#todoTemplate").html(),this.todoContainer=$("#todoList")},render:function(a){var b=tmpl(this.todoViewTemplate,{todoList:a});this.todoContainer.html(b),this.todoContainer.find("li>button.delete").on("click",this.deleteButtonListener)},setDeleteButtonListener:function(a){this.deleteButtonListener=a}};console.log("todos.js");var todoStringField;!function(a,b){todoStringField=a("#todoString");var c=a(".new-task:first");c.on("submit",addTodo),a(document.body).on("onCollectionChange",onTodoChanged),todoView.init(),todoView.setDeleteButtonListener(remove),Storage.loadData()}(jQuery,window);